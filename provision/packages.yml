---
- name: packages playbook
  hosts: dev
  sudo: true
  tasks:
  - name: set repositories
    copy: src=files/etc/apt/sources.list dest=/etc/apt/sources.list owner=root group=root mode=0644
  - name: Add Docker key
    apt_key: keyserver=hkp://p80.pool.sks-keyservers.net:80 id=58118E89F3A912897C070ADBF76221572C52609D
  - name: setup docker repository
    copy: src=files/etc/apt/sources.list.d/docker.list dest=/etc/apt/sources.list.d/docker.list owner=root group=root mode=0644
  - name: add git repository
    apt_repository: repo='ppa:git-core/ppa'
  - name: add neovim repository
    apt_repository: repo='ppa:neovim-ppa/unstable'
  - name: add openjdk repository
    apt_repository: repo='ppa:openjdk-r/ppa'
  - name: update repository cache
    apt: cache_valid_time=3600 update_cache=yes
  - name: install packages
    apt: "name={{ item }} state=latest"
    with_items:
      - ansible
      - automake
      - btrfs-tools
      - build-essential
      - cmake
      - clang
      - ctags
      - docker-engine
      - git
      - gnupg2
      - haskell-platform
      - htop
      - jq
      - keychain
      - libevent-dev
      - libmysqlclient-dev
      - libtool
      - mc
      - mercurial
      - mtr
      - neovim
      - netcat
      - nmap
      - ntp
      - openjdk-8-jre-headless
      - python-dev
      - python-pip
      - scala
      - silversearcher-ag
      - sipcalc
      - socat
      - software-properties-common
      - traceroute
      - tree
  - name: install awscli
    pip: name=awscli state=latest
  - name: add vagrant user to docker group
    user: append=yes groups=docker name=vagrant
  - name: set readline defaults
    copy: src=files/etc/inputrc dest=/etc/inputrc owner=root mode=0644
  - name: upgrade distro
    apt: upgrade=dist
